# Video Clerk

A mobile-first web application that solves the "what do we watch?" conundrum. It separates the **Discovery Phase** (adding things to the list when you hear about them) from the **Decision Phase** (filtering that list based on current mood to find a winner).

## Development

### Installation

Install the dependencies:

```bash
npm install
```

### Development

Start a local Supabase instance:

```bash
npx supabase start
```

Create a `.env` file with the "Authentication Keys" output by this command.
Set `VITE_SUPABASE_PUBLISHABLE_DEFAULT_KEY` and `VITE_SUPABASE_SECRET_KEY`.
Make sure to include `VITE_TMDB_API_READ_TOKEN`, obtained from TMDB.

Start the development server with HMR:

```bash
npm run dev
```

Your application will be available at `http://localhost:5173`.

## Building for Production

Create a production build:

```bash
npm run build
```

## Deployment

### Supabase

Generate migrations and types from any schema updates, and push them to production.

```
npx supabase stop
npx supabase db diff -f <update_description>
npx supabase start
npx supabase gen types typescript --local > app/lib/supabase/database.generated.types.ts
npx supabase db push
```

### GitHub Pages

This project is configured for automatic deployment to GitHub Pages using GitHub Actions.

**Setup Instructions:**

1. **Configure GitHub Variables and Secrets:**
   - Go to your repository settings on GitHub
   - Navigate to **Secrets and variables** → **Actions**
   - Add the following **Variables** (under the "Variables" tab):
     - `PAGES_DOMAIN` - Your custom domain name (e.g., `example.com` or `www.example.com`)
   - Add the following **Secrets** (under the "Secrets" tab):
     - `VITE_SUPABASE_URL` - Your Supabase project URL
     - `VITE_SUPABASE_PUBLISHABLE_DEFAULT_KEY` - Your Supabase anon/public key
     - `VITE_TMDB_API_READ_TOKEN` - Your TMDB API read token

2. **Enable GitHub Pages:**
   - Go to **Settings** → **Pages**
   - Under **Source**, select **GitHub Actions**
   - The workflow will automatically deploy when you push to the `main` branch

3. **Configure Custom Domain (if using):**
   - After the first deployment, go to **Settings** → **Pages**
   - Enter your custom domain in the "Custom domain" field
   - GitHub will automatically configure DNS settings
   - The CNAME file is automatically generated by the workflow

**Important Notes:**

- The base path is set to `/` for custom domain support
- The deployment creates a `404.html` file automatically to handle client-side routing
- The deployment creates a `CNAME` file automatically using the `PAGES_DOMAIN` variable
- Make sure all required variables and secrets are configured before deploying

**Manual Deployment:**

You can also trigger a manual deployment by:
1. Going to the **Actions** tab in your repository
2. Selecting **Deploy to GitHub Pages** workflow
3. Clicking **Run workflow**

### Docker Deployment

To build and run using Docker:

```bash
docker build -t my-app .

# Run the container
docker run -p 3000:3000 my-app
```

The containerized application can be deployed to any platform that supports Docker, including:

- AWS ECS
- Google Cloud Run
- Azure Container Apps
- Digital Ocean App Platform
- Fly.io
- Railway

### DIY Deployment

If you're familiar with deploying Node applications, the built-in app server is production-ready.

Make sure to deploy the output of `npm run build`

```
├── package.json
├── package-lock.json (or pnpm-lock.yaml, or bun.lockb)
├── build/
│   ├── client/    # Static assets
│   └── server/    # Server-side code
```

## Styling

This template comes with [Tailwind CSS](https://tailwindcss.com/) already configured for a simple default starting experience. You can use whatever CSS framework you prefer.
