import{x,a as r,w as y}from"./chunk-JMJ3UQ3L-DPj_BNs_.js";import{j as s}from"./jsx-runtime-u17CrQMm.js";import{c as N}from"./client-B_XR4Hye.js";import{c as o,p as w,s as c,b as g,a as z}from"./utils-ByhHhwOs.js";import{b as C}from"./tmdb-configuration-BxuIu_6_.js";import{c as L}from"./createLucideIcon-CMzVMv86.js";const P=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],S=L("plus",P);function k({to:e,children:t}){return s.jsx(x,{to:e,className:"fixed bottom-[calc(env(safe-area-inset-bottom)+5rem)] right-4 flex h-14 w-14 items-center justify-center rounded-full bg-indigo-500 text-white shadow-lg transition-opacity hover:opacity-90",children:t})}function E({entry:e}){const t=r.useContext(C),a=t.images.poster_sizes.length>2?2:t.images.poster_sizes.length-1,n=t.images.poster_sizes[a]||t.images.poster_sizes[0];return s.jsxs(x,{to:`/app/list/${e.id}`,className:"group flex gap-4 md:gap-6 items-start rounded-lg p-2 -m-2 transition hover:bg-zinc-100 dark:hover:bg-zinc-800 focus-visible:outline focus-visible:outline-2 focus-visible:outline-indigo-500",children:[e.posterPath&&t.images.secure_base_url&&s.jsx("img",{src:`${t.images.secure_base_url}${n}${e.posterPath}`,alt:e.title,className:"flex-shrink-0 w-16 h-24 object-cover rounded md:w-20 md:h-[120px]"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:o("font-bold text-base md:text-lg",w),children:e.title}),e.releaseYear&&s.jsx("p",{className:o("text-sm md:text-base",c),children:e.releaseYear}),e.tags.length>0&&s.jsx("p",{className:o("text-sm md:text-base",c),children:e.tags.join(", ")})]})]})}function A({entries:e,loading:t,error:a}){return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:g,children:s.jsx("h2",{className:z,children:"List of Saved Items"})}),s.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 pb-4",children:[t&&!a&&e.length===0&&s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-zinc-300 border-t-indigo-500"}),s.jsx("p",{className:c,children:"Loading..."})]})}),a&&s.jsx("p",{className:o("text-sm text-red-500",g),children:a}),!t&&!a&&e.length===0&&s.jsx("p",{className:o("text-sm",c),children:"Your list is empty."}),!a&&e.length>0&&s.jsx("div",{className:"space-y-4 md:space-y-6",children:e.map(n=>s.jsx(E,{entry:n},n.id))})]}),s.jsx(k,{to:"/app/list/add",children:s.jsx(S,{})})]})}function I(e){return e&&e.split("-")[0]||""}function Y(e){return e?Array.isArray(e)?e[0]??null:e:null}function T(e){return e?Array.isArray(e)?e[0]?.name??null:e.name??null:null}function $(){const[e,t]=r.useState([]),[a,n]=r.useState(!0),[j,h]=r.useState(null);return r.useEffect(()=>{let l=!1;return(async()=>{n(!0),h(null);try{const i=N(),{data:d,error:f}=await i.from("entries").select(`
              id,
              added_at,
              tmdb_details (
                poster_path,
                name,
                release_date
              ),
              entry_tags (
                tags (
                  name
                )
              )
            `).order("added_at",{ascending:!1});if(f)throw f;const b=(d??[]).map(m=>{const u=Y(m.tmdb_details),_=u?.name||"Untitled",v=m.entry_tags?.map(p=>T(p.tags)).filter(p=>!!p)??[];return{id:m.id,title:_,releaseYear:I(u?.release_date??null),posterPath:u?.poster_path??null,tags:v}});l||t(b)}catch(i){if(!l){const d=i instanceof Error?i.message:typeof i=="object"&&i!==null&&"message"in i&&typeof i.message=="string"?String(i.message):"Failed to load list";h(d),t([])}}finally{l||n(!1)}})(),()=>{l=!0}},[]),s.jsx(A,{entries:e,loading:a,error:j})}function V({}){return[{title:"Video Clerk"},{name:"description",content:'A mobile-first web application that solves the "what do we watch?" conundrum. It separates the **Discovery Phase** (adding things to the list when you hear about them) from the **Decision Phase** (filtering that list based on current mood to find a winner).'}]}const q=y(function(){return s.jsx($,{})});export{q as default,V as meta};
