import{x as _,a as r,w as N}from"./chunk-JMJ3UQ3L-DPj_BNs_.js";import{j as s}from"./jsx-runtime-u17CrQMm.js";import{c as v}from"./client-B_XR4Hye.js";import{c as o,p as w,s as c,b as x,a as C}from"./utils-ByhHhwOs.js";import{b as z}from"./tmdb-configuration-BxuIu_6_.js";import{c as L}from"./createLucideIcon-CMzVMv86.js";const P=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],S=L("plus",P);function E({to:e,children:t}){return s.jsx(_,{to:e,className:"fixed bottom-[calc(env(safe-area-inset-bottom)+5rem)] right-4 flex h-14 w-14 items-center justify-center rounded-full bg-indigo-500 text-white shadow-lg transition-opacity hover:opacity-90",children:t})}function k({entry:e}){const t=r.useContext(z),a=t.images.poster_sizes.length>2?2:t.images.poster_sizes.length-1,i=t.images.poster_sizes[a]||t.images.poster_sizes[0];return s.jsxs("div",{className:"flex gap-4 md:gap-6 items-start",children:[e.posterPath&&t.images.secure_base_url&&s.jsx("img",{src:`${t.images.secure_base_url}${i}${e.posterPath}`,alt:e.title,className:"flex-shrink-0 w-16 h-24 object-cover rounded md:w-20 md:h-[120px]"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:o("font-bold text-base md:text-lg",w),children:e.title}),e.releaseYear&&s.jsx("p",{className:o("text-sm md:text-base",c),children:e.releaseYear}),e.tags.length>0&&s.jsx("p",{className:o("text-sm md:text-base",c),children:e.tags.join(", ")})]})]})}function A({entries:e,loading:t,error:a}){return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:x,children:s.jsx("h2",{className:C,children:"List of Saved Items"})}),s.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 pb-4",children:[t&&!a&&e.length===0&&s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-zinc-300 border-t-indigo-500"}),s.jsx("p",{className:c,children:"Loading..."})]})}),a&&s.jsx("p",{className:o("text-sm text-red-500",x),children:a}),!t&&!a&&e.length===0&&s.jsx("p",{className:o("text-sm",c),children:"Your list is empty."}),!a&&e.length>0&&s.jsx("div",{className:"space-y-4 md:space-y-6",children:e.map(i=>s.jsx(k,{entry:i},i.id))})]}),s.jsx(E,{to:"/app/list/add",children:s.jsx(S,{})})]})}function Y(e){return e&&e.split("-")[0]||""}function I(e){return e?Array.isArray(e)?e[0]??null:e:null}function T(e){return e?Array.isArray(e)?e[0]?.name??null:e.name??null:null}function D(){const[e,t]=r.useState([]),[a,i]=r.useState(!0),[g,h]=r.useState(null);return r.useEffect(()=>{let l=!1;return(async()=>{i(!0),h(null);try{const n=v(),{data:d,error:f}=await n.from("entries").select(`
              id,
              added_at,
              tmdb_details (
                poster_path,
                name,
                release_date
              ),
              entry_tags (
                tags (
                  name
                )
              )
            `).order("added_at",{ascending:!1});if(f)throw f;const j=(d??[]).map(m=>{const u=I(m.tmdb_details),b=u?.name||"Untitled",y=m.entry_tags?.map(p=>T(p.tags)).filter(p=>!!p)??[];return{id:m.id,title:b,releaseYear:Y(u?.release_date??null),posterPath:u?.poster_path??null,tags:y}});l||t(j)}catch(n){if(!l){const d=n instanceof Error?n.message:typeof n=="object"&&n!==null&&"message"in n&&typeof n.message=="string"?String(n.message):"Failed to load list";h(d),t([])}}finally{l||i(!1)}})(),()=>{l=!0}},[]),s.jsx(A,{entries:e,loading:a,error:g})}function V({}){return[{title:"Video Clerk"},{name:"description",content:'A mobile-first web application that solves the "what do we watch?" conundrum. It separates the **Discovery Phase** (adding things to the list when you hear about them) from the **Decision Phase** (filtering that list based on current mood to find a winner).'}]}const q=N(function(){return s.jsx(D,{})});export{q as default,V as meta};
